<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>ステップ3：モグラたたきmini</title>
  <style>
    body{font-family: system-ui, sans-serif; margin:0; display:grid; place-items:center; height:100vh; background:#fff7ed}
    .wrap{background:#fff; padding:24px; border-radius:16px; box-shadow:0 6px 18px rgba(0,0,0,.08); text-align:center}
    .grid{display:grid; grid-template-columns:repeat(3,100px); gap:12px; margin:16px auto}
    .cell{width:100px; height:100px; border-radius:12px; background:#e5e7eb; display:grid; place-items:center; font-size:40px; cursor:pointer; user-select:none}
    .mole{background:#fde68a}
    button{padding:10px 16px; border:none; border-radius:10px; background:#2563eb; color:#fff; cursor:pointer}
  </style>
</head>
<body>
  <div class="wrap">
    <h1>モグラたたき mini</h1>
    <p>30秒で何点とれるかな？</p>
    <div>スコア：<b id="score">0</b> ／ のこり：<b id="time">30</b> 秒</div>
    <div class="grid" id="grid"></div>
    <button id="start">スタート</button>
  </div>

  <script>
    const grid = document.getElementById('grid');
    const scoreEl = document.getElementById('score');
    const timeEl = document.getElementById('time');
    const startBtn = document.getElementById('start');

    const cells = [];
    for (let i=0;i<9;i++){
      const d = document.createElement('div');
      d.className = 'cell';
      d.textContent = '⛰️';
      grid.appendChild(d);
      cells.push(d);
    }

    let score=0, left=30, moleIndex=-1, tickTimer=null, timeTimer=null;

    function setMole(){
      if (moleIndex>=0) cells[moleIndex].classList.remove('mole');
      moleIndex = Math.floor(Math.random()*9);
      cells[moleIndex].classList.add('mole');
    }

    cells.forEach((c, i)=>{
      c.addEventListener('click', ()=>{
        if (i===moleIndex){
          score++;
          scoreEl.textContent = score;
          // 叩いたらすぐ次に
          setMole();
        }
      });
    });

    startBtn.addEventListener('click', ()=>{
      if (tickTimer) return; // 連打防止
      score=0; left=30; scoreEl.textContent = score; timeEl.textContent = left;
      setMole();
      tickTimer = setInterval(setMole, 800); // 0.8秒ごとに移動
      timeTimer = setInterval(()=>{
        left--; timeEl.textContent = left;
        if(left<=0){
          clearInterval(tickTimer); clearInterval(timeTimer);
          tickTimer=null; timeTimer=null; moleIndex=-1;
          cells.forEach(c=>c.classList.remove('mole'));
          alert('おしまい！ スコア：'+score);
        }
      },1000);
    });
  </script>
</body>
</html>